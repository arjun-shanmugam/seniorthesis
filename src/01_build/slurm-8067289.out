## SLURM PROLOG ###############################################################
##    Job ID : 8067289
##  Job Name : dask-worker
##  Nodelist : node2201
##      CPUs : 1
##  Mem/Node : 220160 MB
## Directory : /gpfs/home/ashanmu1/seniorthesis/src/01_build
##   Job Started : Fri Feb  3 23:04:54 EST 2023
###############################################################################
2023-02-03 23:05:24,818 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.20.218.1:37297'. Reason: nanny-close
2023-02-03 23:05:24,818 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.20.218.1:39864'. Reason: nanny-close
2023-02-03 23:05:24,818 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.20.218.1:45558'. Reason: nanny-close
2023-02-03 23:05:24,818 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.20.218.1:43866'. Reason: nanny-close
2023-02-03 23:05:24,818 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.20.218.1:38731'. Reason: nanny-close
2023-02-03 23:05:24,819 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.20.218.1:40286'. Reason: nanny-close
2023-02-03 23:05:24,819 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.20.218.1:33606'. Reason: nanny-close
2023-02-03 23:05:24,819 - distributed.nanny - INFO - Closing Nanny at 'tcp://172.20.218.1:43494'. Reason: nanny-close
2023-02-03 23:05:24,819 - distributed.dask_worker - INFO - End worker
ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/comm/core.py", line 291, in connect
    comm = await asyncio.wait_for(
  File "/users/ashanmu1/miniconda3/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/comm/tcp.py", line 511, in connect
    convert_stream_closed_error(self, e)
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/comm/tcp.py", line 142, in convert_stream_closed_error
    raise CommClosedError(f"in {obj}: {exc.__class__.__name__}: {exc}") from exc
distributed.comm.core.CommClosedError: in <distributed.comm.tcp.TCPConnector object at 0x7fdc80c09900>: ConnectionRefusedError: [Errno 111] Connection refused

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/core.py", line 528, in start
    await asyncio.wait_for(self.start_unsafe(), timeout=timeout)
  File "/users/ashanmu1/miniconda3/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/nanny.py", line 361, in start_unsafe
    msg = await self.scheduler.register_nanny()
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/core.py", line 1218, in send_recv_from_rpc
    comm = await self.pool.connect(self.addr)
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/core.py", line 1439, in connect
    return await connect_attempt
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/core.py", line 1375, in _connect
    comm = await connect(
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/comm/core.py", line 317, in connect
    raise OSError(
OSError: Timed out trying to connect to tcp://172.20.207.1:37259 after 30 s

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/users/ashanmu1/miniconda3/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/users/ashanmu1/miniconda3/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/cli/dask_worker.py", line 539, in <module>
    main()  # pragma: no cover
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/click/core.py", line 1130, in __call__
    return self.main(*args, **kwargs)
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/click/core.py", line 1055, in main
    rv = self.invoke(ctx)
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/click/core.py", line 1404, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/click/core.py", line 760, in invoke
    return __callback(*args, **kwargs)
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/cli/dask_worker.py", line 445, in main
    asyncio.run(run())
  File "/users/ashanmu1/miniconda3/lib/python3.10/asyncio/runners.py", line 44, in run
    return loop.run_until_complete(main)
  File "/users/ashanmu1/miniconda3/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/cli/dask_worker.py", line 442, in run
    [task.result() for task in done]
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/cli/dask_worker.py", line 442, in <listcomp>
    [task.result() for task in done]
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/cli/dask_worker.py", line 417, in wait_for_nannies_to_finish
    await asyncio.gather(*nannies)
  File "/users/ashanmu1/miniconda3/lib/python3.10/asyncio/tasks.py", line 650, in _wrap_awaitable
    return (yield from awaitable.__await__())
  File "/gpfs/home/ashanmu1/seniorthesis/venv/lib/python3.10/site-packages/distributed/core.py", line 536, in start
    raise RuntimeError(f"{type(self).__name__} failed to start.") from exc
RuntimeError: Nanny failed to start.
